## 소프트웨어 취약점

소프트웨어 취약점 :  사용자에게 허가된 권한 이상의 동작이나 정보 열람을 가능하게 하는 소프트웨어 설계 상의 허점이나 결함 (소프트웨어뿐 아니라 하드웨어, 절차 및 관리 등이 모두 포함됨)

- Exploit : 취약점 공격 코드

    취약점이 발견되면 해당 취약점을 공격하여 원하는 코드를 실행하거나 특정 목성을 달성하는 공격 코드

    초창기에는 대부분 C나 Perl로 작성되었으나, 최근에는 대부분 Python이나 Ruby로 작성됨

    스크립트 언어는 컴파일이 필요 없기 때문에 빠르게 수정이 가능하여 쉽게 공격 코드를 작성할 수 있음

취약점 발견 및 패치

- zero-day 공격 : 취약점이 발견되고 패치가 개발되기 전까지의 기간에 이루어지는 공격 (방어 불가)

## 취약점 분류

(1) Memory Corruption 취약점

버그로 인한 메모리 오염 (예상되지 않은 메모리 값 변경이나 참조 등)에 의해 발생

안전하지 않은 함수 사용이나 잘못된 함수 사용 등 프로그래밍 실수로 인해 발생

Memory Corruption에 속한 대부분의 취약점은 Exploit이 가능하지만 일부 제약이 존재함

1. Stack Buffer Overflow

    메모리 경계를 검사하지 않는 함수 사용으로 인해 스택을 덮어쓰게 되어 발생

    대표적 취약 함수 (경계 값 검사하지 않음)

    - strcpy, gets, scanf, strcat, getwd, sprintf

    문자열 길이를 검사하는 함수를 사용하더라도 동적으로 문자열의 길이를 입력받는 경우 취약점 발생 가능

    > char buf[20];                                                                                                                   len = strlen(argv[1]);                                                                                          strncpy(buf, argv[1], len); //문자열 길이가 20을 넘을 시 BOF 발생

2. Heap Buffer Overflow

    스택 버퍼 오버플로우와 유사하지만, 힙 메모리에서 일어남

    메모리 구조가 스택과 다르므로, 취약점 공격 기법도 다름

3. Integer Overflow

    정해진 자료형보다 큰 수를 저장할 때 발생하는 오버플로우 문제

    조건문 등에서 정해진 분기문이 아닌 다른 분기문이 실행되도록 하여 취약점 발생 가능

4. Format String Bug

    포맷 스트링을 지정해주지 않고 사용할 때 발생하는 취약점

    %n, %hn 등의 일부 포맷 스트링을 이용하여 메모리 값을 변조함

5. Use-After-Free

    브라우저에서 많이 발견됨

    Free된 포인터를 사용할 때 발생

    자바스크립트나 파일 로딩 등으로 힙 메모리를 조작할 수 있는 상황에서 공격 가능

6. Double Free

    Free된 메모리를 다시 Free할 때 발생 (대부분 프로그래밍 실수로 인해 발생함)

    Integer Overflow 같은 취약점으로 인해 발생하기도 함

7. Null Pointer Deference

    메모리 값이 지정되지 않고 초기화되지 않은 널 포인터에 값을 넣으려 할 때 발생

(2) Exploit 분류

1. Local Exploit

    Local Exploit : PC 혹은 서버 내부에서 실행하는 Exploit으로 일반적으로 권한 상승이나 코드 실행을 위해 사용됨

    Local Exploit을 하기 위해서는 대상 프로그램에 인자 값을 직접 입력할 수 있거나, 공격 코드가 들어 있는 특정 파일을 대상 프로그램에서 로드하게 해야 함 (PC 권한을 이미 가지고 있거나 특정 파일을 실행하도록 유도해야함)

    윈도우의 경우 직접 인자 값을 입력하는 방식의 공격보다는, 악성 파일을 이용한 공격이 주를 이룸

2. Remote Exploit

    Remote Exploit  : 원격에서 이루어지는 공격으로, 원격에서 패킷을 보내 공격하므로 특정 포트를 열고 서비스를 제공하는 서버 프로그램이 타겟이 됨 (서버의 접근 권한을 얻기 위한 1차 공격으로 사용)

    포트가 열려 있는 것만으로도 원격에서 공격을 당할 수 있기 때문에 대부분 치명적

    서버 뿐 아니라 일반 PC도 얼마든지 공격 타깃이 될 수 있음 

Remote Exploit을 통해 서버의 일반 사용자 권한을 획득한 뒤, Local Exploit을 통해 추가 권한 상승을 시도하는 것이 일반적인 침투 절차임
